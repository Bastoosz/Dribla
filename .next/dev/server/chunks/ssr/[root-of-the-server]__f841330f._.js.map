{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2011/Desktop/Dribla/dribla_frontend/components/Layout.tsx"],"sourcesContent":["import React, { ReactNode } from 'react';\r\nimport Head from 'next/head';\r\n\r\ninterface LayoutProps {\r\n  children: ReactNode;\r\n  title?: string;\r\n}\r\n\r\nexport default function Layout({ children, title = 'Dribla' }: LayoutProps) {\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>{title}</title>\r\n        <meta name=\"description\" content=\"Plataforma de gestão financeira para professores de futebol\" />\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n        <link rel=\"icon\" href=\"/favicon.ico\" />\r\n      </Head>\r\n\r\n      <div className=\"min-h-screen flex flex-col bg-gray-50\">\r\n        {/* O header foi movido para um componente separado */}\r\n        <main className=\"flex-grow container mx-auto px-4 py-8\">\r\n          {children}\r\n        </main>\r\n        \r\n        <footer className=\"bg-white border-t py-4\">\r\n          <div className=\"container mx-auto px-4 text-center text-sm text-gray-600\">\r\n            © {new Date().getFullYear()} Dribla. Todos os direitos reservados.\r\n          </div>\r\n        </footer>\r\n      </div>\r\n    </>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;;;AAOe,SAAS,OAAO,EAAE,QAAQ,EAAE,QAAQ,QAAQ,EAAe;IACxE,qBACE;;0BACE,qKAAC,gIAAI;;kCACH,qKAAC;kCAAO;;;;;;kCACR,qKAAC;wBAAK,MAAK;wBAAc,SAAQ;;;;;;kCACjC,qKAAC;wBAAK,MAAK;wBAAW,SAAQ;;;;;;kCAC9B,qKAAC;wBAAK,KAAI;wBAAO,MAAK;;;;;;;;;;;;0BAGxB,qKAAC;gBAAI,WAAU;;kCAEb,qKAAC;wBAAK,WAAU;kCACb;;;;;;kCAGH,qKAAC;wBAAO,WAAU;kCAChB,cAAA,qKAAC;4BAAI,WAAU;;gCAA2D;gCACrE,IAAI,OAAO,WAAW;gCAAG;;;;;;;;;;;;;;;;;;;;AAMxC","debugId":null}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2011/Desktop/Dribla/dribla_frontend/lib/supabaseClient.ts"],"sourcesContent":["// lib/supabaseClient.ts\r\n\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\n// Variáveis de ambiente devem ser configuradas no Vercel e no .env.local\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\n// Verifica se as chaves existem antes de criar o cliente\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  // Lançar um erro claro para o ambiente de desenvolvimento/compilação\r\n  throw new Error(\"As variáveis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY devem estar definidas.\");\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n"],"names":[],"mappings":"AAAA,wBAAwB;;;;;AAExB;;AAEA,yEAAyE;AACzE,MAAM;AACN,MAAM;AAEN,yDAAyD;AACzD;;AAKO,MAAM,WAAW,IAAA,iKAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2011/Desktop/Dribla/dribla_frontend/pages/home-acao.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Head from 'next/head';\r\nimport Layout from '../components/Layout';\r\nimport { supabase } from '../lib/supabaseClient';\r\nimport { useRouter } from 'next/router';\r\nimport Link from 'next/link';\r\nimport { Loader2, DollarSign, Users, AlertTriangle, Clock } from 'lucide-react';\r\n\r\n// Tipagem para os dados do Dashboard\r\ninterface DashboardData {\r\n  atrasadosCount: number;\r\n  atrasadosValorTotal: number;\r\n  proximosCount: number;\r\n  totalAlunos: number;\r\n  planoAtual: 'free' | 'vip' | 'premium';\r\n  limiteAlunos: number;\r\n}\r\n\r\nconst HomeAcao: React.FC = () => {\r\n  const router = useRouter();\r\n  const [data, setData] = useState<DashboardData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchDashboardData = async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      // 1. Pega o Usuário (Auth)\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      if (!user) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // --- Executar todas as queries em paralelo ---\r\n        const [\r\n          treinadorPromise,\r\n          atrasadosPromise,\r\n          proximosPromise,\r\n          totalAlunosPromise\r\n        ] = await Promise.all([\r\n          // Busca dados do Treinador\r\n          supabase\r\n            .from('treinadores')\r\n            .select('plano_atual, limite_alunos')\r\n            .eq('id', user.id)\r\n            .single(),\r\n          \r\n          // Busca Atrasados (Contagem e Soma)\r\n          supabase\r\n            .from('alunos')\r\n            .select('valor_mensalidade', { count: 'exact' }) // Pega valor para somar e a contagem\r\n            .eq('id_treinador', user.id)\r\n            .eq('status_mensalidade', 'vencida'),\r\n\r\n          // Busca Próximos (Apenas Contagem)\r\n          supabase\r\n            .from('alunos')\r\n            .select('*', { count: 'exact', head: true }) // head: true só conta, não retorna dados\r\n            .eq('id_treinador', user.id)\r\n            .eq('status_mensalidade', 'proximo'),\r\n\r\n          // Busca Total de Alunos (Apenas Contagem)\r\n          supabase\r\n            .from('alunos')\r\n            .select('*', { count: 'exact', head: true }) \r\n            .eq('id_treinador', user.id),\r\n        ]);\r\n\r\n        // --- Processar os Resultados ---\r\n\r\n        // Treinador\r\n        if (treinadorPromise.error) throw new Error(\"Erro ao buscar dados do plano.\");\r\n        const treinadorInfo = treinadorPromise.data;\r\n\r\n        // Atrasados\r\n        if (atrasadosPromise.error) throw new Error(\"Erro ao buscar alunos atrasados.\");\r\n        const atrasadosCount = atrasadosPromise.count ?? 0;\r\n        // Calcula a soma dos valores - IMPORTANTE: Supabase não faz SUM direto com count na mesma query via JS client\r\n        // A melhor forma seria uma Supabase Function (RPC) ou calcular no client-side\r\n        let atrasadosValorTotal = 0;\r\n        if (atrasadosPromise.data) {\r\n           atrasadosValorTotal = atrasadosPromise.data.reduce((sum, aluno) => sum + (aluno.valor_mensalidade || 0), 0);\r\n        }\r\n\r\n\r\n        // Próximos\r\n        if (proximosPromise.error) throw new Error(\"Erro ao buscar próximos vencimentos.\");\r\n        const proximosCount = proximosPromise.count ?? 0;\r\n\r\n        // Total Alunos\r\n        if (totalAlunosPromise.error) throw new Error(\"Erro ao buscar total de alunos.\");\r\n        const totalAlunos = totalAlunosPromise.count ?? 0;\r\n\r\n        // --- Atualizar Estado ---\r\n        setData({\r\n          atrasadosCount,\r\n          atrasadosValorTotal,\r\n          proximosCount,\r\n          totalAlunos,\r\n          planoAtual: treinadorInfo.plano_atual,\r\n          limiteAlunos: treinadorInfo.limite_alunos,\r\n        });\r\n\r\n      } catch (err: any) {\r\n        console.error(\"Erro no Dashboard:\", err.message);\r\n        setError(\"Não foi possível carregar os dados do painel.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchDashboardData();\r\n  }, [router]);\r\n\r\n  // --- Funções Auxiliares de Formatação ---\r\n  const formatCurrency = (value: number) => {\r\n    return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>Dribla | Zona de Ação</title>\r\n      </Head>\r\n      <Layout title=\"Zona de Ação Financeira\">\r\n        \r\n        {loading && (\r\n          <div className=\"flex justify-center items-center py-20\">\r\n            <Loader2 className=\"w-12 h-12 text-dribla-green animate-spin\" />\r\n          </div>\r\n        )}\r\n\r\n        {error && (\r\n          <div className=\"p-4 mb-6 bg-dribla-orange/20 text-dribla-orange rounded-lg border border-dribla-orange text-center\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        {!loading && data && (\r\n          <>\r\n            <h1 className=\"text-3xl font-bold mb-8 text-white\">Pronto para a Ação, Treinador!</h1>\r\n            \r\n            {/* DOIS CARTÕES GIGANTES de Foco (AGORA COM DADOS REAIS) */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12\">\r\n              {/* Cartão 1: INADIMPLÊNCIA */}\r\n              <div className=\"bg-gray-800 p-8 rounded-xl shadow-2xl border-l-4 border-dribla-orange\">\r\n                <h2 className=\"text-xl font-semibold text-gray-200 mb-4 flex items-center\">\r\n                  <AlertTriangle className=\"w-5 h-5 mr-2 text-dribla-orange\" /> Atenção! Cobranças Pendentes\r\n                </h2>\r\n                <p className=\"text-5xl font-extrabold text-dribla-orange mb-4\">\r\n                  {formatCurrency(data.atrasadosValorTotal)}\r\n                </p>\r\n                <p className=\"text-gray-400 mb-6\">{data.atrasadosCount} Alunos Atrasados</p>\r\n                <Link href=\"/elenco?filtro=vencida\">\r\n                  <button className=\"w-full py-3 bg-dribla-orange text-gray-900 font-bold rounded-lg hover:bg-orange-500 transition duration-200\">\r\n                    RESOLVER AGORA\r\n                  </button>\r\n                </Link>\r\n              </div>\r\n\r\n              {/* Cartão 2: PRÓXIMOS VENCIMENTOS */}\r\n              <div className=\"bg-gray-800 p-8 rounded-xl shadow-2xl border-l-4 border-dribla-green\">\r\n                <h2 className=\"text-xl font-semibold text-gray-200 mb-4 flex items-center\">\r\n                  <Clock className=\"w-5 h-5 mr-2 text-dribla-green\" /> Próximos Pagamentos\r\n                </h2>\r\n                <p className=\"text-5xl font-extrabold text-dribla-green mb-4\">{data.proximosCount}</p>\r\n                <p className=\"text-gray-400 mb-6\">Alunos com vencimento nos próximos 5 dias</p>\r\n                 <Link href=\"/elenco?filtro=proximo\">\r\n                  <button className=\"w-full py-3 bg-dribla-green text-gray-900 font-bold rounded-lg hover:bg-green-600 transition duration-200\">\r\n                    VER ALUNOS\r\n                  </button>\r\n                 </Link>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Seção de Ocupação do Time / Registro Rápido */}\r\n            <div className=\"bg-gray-900 p-6 rounded-xl border border-gray-800 flex flex-col md:flex-row justify-between items-center gap-4\">\r\n              <div className='text-center md:text-left'>\r\n                <h2 className=\"text-lg font-semibold text-white mb-1 flex items-center\">\r\n                  <Users className='w-5 h-5 mr-2 text-dribla-green'/> Status do seu Plano\r\n                </h2>\r\n                <p className='text-gray-400 text-sm'>\r\n                  Plano: <span className='font-bold uppercase text-dribla-green'>{data.planoAtual}</span> | \r\n                  Ocupação: <span className='font-bold text-white'>{data.totalAlunos}</span> / <span className='text-gray-500'>{data.limiteAlunos === 99999 ? 'Ilimitado' : data.limiteAlunos}</span>\r\n                </p>\r\n              </div>\r\n              <div className='flex space-x-4'>\r\n                <Link href=\"/checkout?plano=VIP\">\r\n                    <button className='px-4 py-2 text-sm bg-gray-700 hover:bg-dribla-green hover:text-gray-900 rounded-lg transition duration-200'>\r\n                        Fazer Upgrade\r\n                    </button>\r\n                </Link>\r\n                 <Link href=\"/elenco\">\r\n                    <button className='px-4 py-2 text-sm bg-dribla-green text-gray-900 font-semibold rounded-lg hover:bg-green-600 transition duration-200'>\r\n                        Gerenciar Elenco\r\n                    </button>\r\n                 </Link>\r\n              </div>\r\n            </div>\r\n          </>\r\n        )}\r\n      </Layout>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default HomeAcao;"],"names":[],"mappings":"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","debugId":null}}]
}